# ADR: タスク削除戦略の決定

## ステータス

承認済み

## 日付

2025-03-08

## 背景

タスク管理システムにおいて、不要になったタスクを削除する機能が必要となっています。削除実装方針として、以下の2つのアプローチが検討されました：

1. **論理削除** - 削除フラグを設定し、データは残したまま表示から隠す
2. **物理削除** - データベースから完全にデータを削除する

この決定は、データの永続性、復元可能性、パフォーマンス、およびユーザー体験に影響を与えます。

## 決定

**物理削除方式を採用する。**

タスクの削除は、データストアからタスクを完全に削除する物理削除方式で実装します。削除されたタスクは復元できません。

## 根拠

1. 本アプリケーションは個人用タスク管理であり、削除されたタスクの復元ニーズは低いと判断
2. 物理削除はシンプルな実装で、データモデルに削除フラグなどの追加フィールドが不要
3. ストレージ容量の効率的な使用（削除されたデータが蓄積しない）
4. パフォーマンスの向上（フィルタリング条件が少なくなる）
5. プライバシーとデータ保護の観点から、不要なデータを完全に削除する方針に合致

## 影響

### 肯定的影響

- 実装がシンプルになる
- データストアが最小限のサイズに保たれる
- クエリのパフォーマンスが向上する
- データ保護規制の遵守が容易になる

### 否定的影響

- 誤って削除されたタスクは復元できない
- 削除操作の前に確認ダイアログが必要になる
- 履歴追跡や監査目的では限定的な情報しか残らない

### 中立的影響

- タスク削除のAPIとインターフェースは同じままだが、内部実装が異なる
- 将来的に論理削除に切り替える場合は、API互換性を維持しながら変更可能

## オプション

### オプション1: 論理削除（却下）

**長所**:
- 誤って削除されたデータを復元できる
- データの履歴を保持でき、分析や監査に役立つ
- 削除の取り消し機能を容易に実装できる

**短所**:
- データモデルに削除フラグと削除日時フィールドが必要
- データベースサイズが時間とともに増大する
- クエリに常に削除フラグのフィルタリングが必要で複雑になる
- 実装の複雑さが増す

### オプション2: 物理削除（採用）

**長所**:
- 実装がシンプル
- ストレージ効率が良い
- クエリパフォーマンスが良い
- データ保護の観点から適切

**短所**:
- 削除されたデータは復元不可能
- 履歴分析や監査証跡が限定的

## 採用基準

- 本システムは個人用タスク管理であり、厳格な監査要件がない
- シンプルさとパフォーマンスを優先する設計方針
- タスク管理のドメインでは誤削除による重大な影響が少ない
- ストレージ効率とクエリパフォーマンスの最適化が望ましい

## 修正履歴

| 日付 | 変更者 | 変更内容 |
|------|-------|----------|
| 2025-03-08 | 開発チーム | 初版作成 |
| 2025-03-10 | 開発チーム | ドキュメント整理に伴う移動と形式の更新 |

## 関連ドキュメント

- [タスク管理ドメイン設計](../../domain/task/design.md)
- [タスク管理ドメイン実装詳細](../../domain/task/implementation.md)