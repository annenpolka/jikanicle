# jikanicle プロジェクトロードマップ

## 更新履歴

| 日付 | 更新者 | 内容 |
|------|--------|------|
| 2025-03-10 | 開発チーム | 既存ドキュメントの統合によるメインロードマップ作成 |
| 2025-03-10 | 開発チーム | ファイルベースリポジトリ実装完了とZustand状態管理実装の反映 |
| 2025-03-10 | 開発チーム | 日付ライブラリ調査と導入計画の追加 |

## 1. プロジェクト全体の実装方針

jikanicleプロジェクトは、以下の基本方針に基づいて実装を進めます：

- **インクリメンタル開発**: 機能を小さな単位で実装し、継続的に動作するソフトウェアを維持する
- **垂直スライス**: 各機能をUI層からインフラストラクチャ層まで垂直に実装する
- **テスト駆動開発**: "Red-Green-Refactor"サイクルに基づく開発
- **継続的リファクタリング**: 技術的負債を蓄積せず、コード品質を維持する

## 2. マイルストーンとタイムライン

### フェーズ1: 基本インフラの構築（1週目）

- プロジェクト設定とドメインモデル実装
- 基本的なデータアクセス層の実装
- TUIの基本フレームワーク構築

### フェーズ2: コア機能の実装（2-3週目）

- タスク管理基本機能（追加・編集・削除）
- タイムブロッキング基本機能
- タイムトラッキング基本機能

### フェーズ3: AI予測統合（4週目）

- 外部AI APIまたはローカルAIの統合
- 予測機能と学習機能の実装

### フェーズ4: 機能強化とUI改善（5週目）

- 分析・レポート機能の追加
- UI/UXの改善
- パフォーマンス最適化

### フェーズ5: テスト、修正、リリース準備（6週目）

- End-to-Endテスト
- バグ修正
- ドキュメント整備
- リリース準備

## 3. 詳細な実装タスク

このロードマップでは、各フェーズの詳細な実装タスクを記載します。各ドメイン固有の詳細については、以下の関連ドキュメントを参照してください：

- [プロジェクト現状とバックログ](./status.md)
- [タスク管理ドメインステータス](../domain/task/status.md)
- [時間管理ドメインステータス](../domain/time/status.md)（計画中）

### フェーズ1: 基本インフラの構築

#### 3.1.1 プロジェクト設定（優先度: 高）

- [x] プロジェクト基本設定（package.json, tsconfig.json）
- [x] Inkとその依存関係のインストール
- [x] ディレクトリ構造の作成
- [x] テストフレームワーク（Vitest）のセットアップ
- [x] Lintとフォーマッタの設定

#### 3.1.1.1 状態管理基盤の導入（優先度: 高）

- [x] Zustandライブラリのインストールと設定
- [x] 境界づけられたコンテキストごとのストア設計
- [x] ストアとドメイン層の連携パターンの確立
- [ ] ESLintルールの更新（状態管理規約の追加）

#### 3.1.2 ドメインモデル実装（優先度: 高）

- [x] 共通型定義（src/domain/types/Task.ts）
- [x] スキーマ定義（src/domain/schemas/task-schema.ts）
- [x] ファクトリ関数実装（src/domain/factories/task-factory.ts）
- [x] タスク更新機能実装（src/domain/factories/update-task.ts）
- [x] コマンド関数実装（src/domain/commands/delete-task.ts）
- [ ] ドメインサービス実装（src/domain/services/）

#### 3.1.3 データアクセス層実装（優先度: 高）

- [x] リポジトリインターフェース定義（src/application/repositories/task-repository.ts）
- [x] インメモリリポジトリ実装（src/infrastructure/repositories/in-memory-task-repository.ts）
- [x] ファイルベースのリポジトリ実装（完了）
- [x] タスクシリアライズ/デシリアライズユーティリティの実装
- [ ] データストレージ初期化ロジック

#### 3.1.3.1 日付処理抽象化レイヤーの実装（優先度: 中）

- [ ] 日付処理サービスインターフェース（DateService）の定義
- [ ] ネイティブDateによる基本実装
- [ ] 日付値オブジェクト（TaskDate）の実装
- [ ] 単体テストの作成
- [ ] 既存コードへの段階的な統合

#### 3.1.4 TUI基本構造（優先度: 中）

- [ ] メインアプリケーションコンポーネント（src/ui/app.tsx）
- [x] 状態管理ストアの実装（src/ui/state/stores/task-store.ts）
- [ ] 基本レイアウトコンポーネント（ヘッダー、フッター等）
- [ ] ナビゲーション仕組み
- [ ] キーボードショートカット処理
- [ ] ストアとUIコンポーネントの連携

### フェーズ2: コア機能の実装

#### 3.2.1 タスク管理機能（優先度: 高）

- [ ] タスク入力フォーム実装
- [ ] タスクリスト表示コンポーネント
- [ ] タスク詳細表示コンポーネント
- [ ] タスク編集機能
- [ ] タスク削除機能
- [ ] タスクフィルタリング機能
- [ ] タスク期限日付の操作と表示

#### 3.2.2 日付ライブラリ導入（優先度: 中）

- [ ] date-fnsのインストールと設定
- [ ] DateServiceのdate-fns実装への切り替え
- [ ] 既存のDate処理のリファクタリング
- [ ] 日付フォーマット機能の拡充

#### 3.2.3 タイムブロッキング機能（優先度: 高）

- [ ] タイムブロック生成アルゴリズム実装
- [ ] スケジュール表示コンポーネント
- [ ] 日付範囲選択と操作機能
- [ ] タイムブロック手動調整機能
- [ ] タイムブロックの視覚的表現

#### 3.2.4 タイムトラッキング機能（優先度: 高）

- [ ] タイマーコンポーネント実装
- [ ] タスク開始/停止/一時停止機能
- [ ] 経過時間の計算と表示
- [ ] 実績時間の記録機能
- [ ] 作業状況のリアルタイム表示
- [ ] 実績データの日付単位での集計

## 4. 開発プロセスと品質管理

### 4.1 ブランチ戦略

- **main**: 常に動作する安定版
- **develop**: 開発中の機能統合
- **feature/{機能名}**: 個別機能開発
- **fix/{問題ID}**: バグ修正

### 4.2 コミット規約

- **feat**: 新機能追加
- **fix**: バグ修正
- **refactor**: リファクタリング（機能変更なし）
- **docs**: ドキュメントのみの変更
- **style**: コードスタイルの変更（空白、フォーマット等）
- **test**: テスト関連の変更
- **chore**: ビルドプロセスや補助ツールの変更

### 4.3 テスト戦略

- 各コミットには関連するテストを含める
- テストカバレッジ目標：70%以上
- CI/CDパイプラインでの自動テスト実行

## 5. リスクと対策

### 5.1 技術的リスク

| リスク | 影響 | 対策 |
|-------|------|------|
| Inkの制限による複雑UIの実装困難 | 中 | シンプルさを保持、必要に応じて独自コンポーネント開発 |
| ファイルベースのデータストアの限界 | 中 | 初期段階ではデータ量制限、将来的にSQLiteへの移行パス確保 |
| 複雑な日付操作に伴うバグ発生リスク | 中 | 日付処理の抽象化と適切なライブラリ導入 |
| 外部AI APIの応答遅延 | 高 | キャッシュ機構、ローカル予測バックアップ |
| 複数デバイス間の同期問題 | 低 | 初期段階では単一デバイス集中、後期でGit連携検討 |

## 6. 次のステップとプライオリティ

現在のプロジェクト状況に基づき、以下のタスクを優先的に実施します：

1. アプリケーションサービス層を実装し、ユースケースを定義する
2. TUIの基本コンポーネントを実装する
3. UIコンポーネントとZustandストアの連携機能を実装する
4. データストレージ初期化ロジックの実装
5. 日付処理の抽象化レイヤーを実装する（DateServiceインターフェース）

### 2025年3月10日現在の実装状況

- [x] プロジェクト基本設定（package.json, tsconfig.json）完了
- [x] ドメインモデルの実装：タスク関連の型定義とスキーマの統合
- [x] タスクエンティティの型定義と操作関数の実装
- [x] タスク作成ファクトリ関数の実装とテスト
- [x] タスク更新機能の実装とテスト
- [x] タスク削除機能の実装とテスト
- [x] タスクリポジトリインターフェースの定義
- [x] インメモリリポジトリの実装とテスト
- [x] ファイルベースのリポジトリ実装
- [x] タスクシリアライズ/デシリアライズユーティリティの実装
- [x] Zustand状態管理の基本実装
- [x] 日付ライブラリの評価と導入計画の策定
- [ ] アプリケーションサービス層の実装
- [ ] TUIの基本構造実装